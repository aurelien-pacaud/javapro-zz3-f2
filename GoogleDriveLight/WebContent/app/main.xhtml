<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:cc="http://java.sun.com/jsf/composite">
	
<h:head>
	<title>Google Drive Light</title>
</h:head>
<h:body>
	
	<!-- Permet la deconnexion -->
	<h:form>
		<p:commandLink id="ajax" actionListener="#{loginManagedBean.logout}" ajax="false">  
        	<h:outputText value="#{loginManagedBean.username}" />  
    	</p:commandLink>
    </h:form>
	
	<!-- Barre d'outils (haut) -->
	<h:form id="menuBar">
		<p:menubar>  
			<p:submenu label="#{msg['labelMenuFile']}" >  
			    <p:submenu label="#{msg['labelMenuFileNew']}" >  
			        <p:menuitem value="#{msg['labelMenuFileNewTextFile']}" oncomplete="dlgNewTxtFile.show()" icon="ui-icon-document"/>
			        <p:menuitem value="#{msg['labelMenuFileNewPresentationFile']}" icon="ui-icon-contact"/>
			        <p:menuitem value="#{msg['labelMenuFileNewDrawFile']}" icon="ui-icon-image"/>
			        <p:separator /> 
			        <p:menuitem value="#{msg['labelMenuFileNewDirectory']}" icon="ui-icon-folder-collapsed"/>  
			    </p:submenu> 
			    <p:separator />  
			    <p:menuitem value="#{msg['labelMenuFileQuit']}" icon="ui-icon-squaresmall-close"/>  
			</p:submenu>  
		</p:menubar>
	</h:form>
	
	<!-- Les éléments suivants sont organisés selon un layout -->
	<p:layout>
	
		<!-- Arbre des fichiers (gauche) -->
		<p:layoutUnit position="west" size="330" header="#{msg['drive']}" resizable="true">
		    <h:form id="formTree">
			   <p:tree value="#{driveManagedBean.model}" var="node" dynamic="true" cache="true" 
			           id="tree"
			           selection="#{driveManagedBean.selectedNode}"  			 
                  	   selectionMode="single" >
                  	   
                   <p:ajax event="select" listener="#{driveManagedBean.onNodeSelect}" update=":formTable, :formDetails" />	   
			       <p:treeNode>
			           <h:graphicImage alt="folder" value="/images/folder.png"/> <h:outputText value=" #{node}" id="lblNode"/>
			       </p:treeNode>
			   </p:tree>		
			</h:form>				
	    </p:layoutUnit>
	    
	    <!-- Détails d'un répertoire (centre) -->
		<p:layoutUnit position="center">	
		    <h:form id="formTable">		  
			    <p:dataTable id="table" var="file" value="#{driveManagedBean.dirContent}" 
			    			 selection="#{driveManagedBean.selectedFile}"
			                 selectionMode="single" rowKey="#{file.path}">		        
			       			       	
			        <p:ajax event="rowSelect" listener="#{driveManagedBean.onRowSelect}" update=":formDetails" />			        
			        
			        <f:facet name="header">  
            			#{driveManagedBean.currentDirectory}  
        			</f:facet>			        
			        
			        <p:column sortBy="#{file.name}">
			            <f:facet name="header">
			            	Name
			            </f:facet>
			            <h:graphicImage value="/images/#{file.type.toString().toLowerCase()}.png"/> <h:outputText value=" #{file.name}"/>
			        </p:column>
			
			        <p:column sortBy="#{file.type}">
			            <f:facet name="header">
			                    Type
			            </f:facet>
			            <h:outputText value="#{file.type}" />
			        </p:column>
			
			        <p:column sortBy="#{file.size}">
			            <f:facet name="header">
			                    Size
			            </f:facet>
			            <h:outputText value="#{file.size}"> <f:convertNumber pattern="#.## Mo" /> </h:outputText>
			        </p:column>
			
			        <p:column>
			            <f:facet name="header">
			                    Last Updated
			            </f:facet>
			            <h:outputText value="#{file.lastModified}"><f:convertDateTime dateStyle="short" type="both" /> </h:outputText>
			        </p:column>
			    </p:dataTable>
			
			</h:form>
					
	    </p:layoutUnit>
	    
	    <!-- Détails d'un fichier (gauche) -->
	    <p:layoutUnit position="east" size="330" header="#{msg['details']}" resizable="true">
		    <h:form id="formDetails">
			   <p:dataTable id="table" var="file" value="#{driveManagedBean.selectedFile}" rendered="#{driveManagedBean.selectedFile != null}">
			        <p:column>
			            <f:facet name="header">
			            	File Name
			            </f:facet>
			            <h:outputText value="#{file.name}"/>
			        </p:column>
			        
			        <p:column>
			            <f:facet name="header">
			            	Size
			            </f:facet>
			            <h:outputText value="#{file.size}"/>
			        </p:column>
				</p:dataTable>
				
				<h:outputText value="#{msg['fileDetails']}" rendered="#{driveManagedBean.selectedFile == null}"></h:outputText>
			</h:form>				
	    </p:layoutUnit>
	    
	</p:layout>
	
	

</h:body>
</html>